(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{"0dce":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-card",{staticClass:"my-card"},[a("q-card-section",[a("div",{staticClass:"text-h5"},[t._v("Gestão de viajens")]),a("div",{staticClass:"text-subtitle2"},[t._v("Se possui algum camião vago, registe-o aqui junto do percurso que vai seguir")])]),a("q-card-section",{staticClass:"q-pt-none"},[[a("div",{},[a("q-btn",{staticClass:"q-mr-lg",attrs:{to:"/viagem/criar",color:"secondary",label:"Criar",icon:"add"}}),a("q-btn",{staticClass:"q-mr-lg",attrs:{to:"/viagem",color:"secondary",label:"Listar",icon:"visibility"}}),a("q-btn",{staticClass:"q-mr-lg",attrs:{to:"/viagem?news=novo",color:"secondary",label:"Listar novos",icon:"visibility"}})],1)]],2)],1)],1)},o=[],i={},n=i,r=a("2877"),l=a("f09f"),c=a("a370"),d=a("9c40"),u=a("eebe"),g=a.n(u),p=Object(r["a"])(n,s,o,!1,null,null,null);e["a"]=p.exports;g()(p,"components",{QCard:l["a"],QCardSection:c["a"],QBtn:d["a"]})},ed0c:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("header-freight-journey"),a("div",{staticClass:"q-pt-md"},[[a("div",{staticClass:"q-mt-md"},[a("q-table",{attrs:{title:"Viagens",data:t.rows,loading:t.loading,pagination:t.pagination,"binary-state-sort":"",columns:t.columns,filter:t.filter,"row-key":"id"},on:{"row-click":t.goTo,"update:pagination":function(e){t.pagination=e},request:t.onRequest},scopedSlots:t._u([{key:"top-right",fn:function(){return[a("q-input",{attrs:{borderless:"",dense:"",debounce:"300",placeholder:"Pesquise"},scopedSlots:t._u([{key:"append",fn:function(){return[a("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})]},proxy:!0}])})],1)]],2)],1)},o=[],i=(a("ddb0"),a("2b3d"),a("0dce")),n={components:{HeaderFreightJourney:i["a"]},data(){return{pagination:{sortBy:"id",descending:!1,page:1,rowsPerPage:3,rowsNumber:10},filter:"",columns:[{name:"id",required:!0,label:"id",align:"left",field:t=>t.id,format:t=>`${t}`,sortable:!0},{name:"from_location",required:!0,label:"Partida",align:"left",field:t=>t.from_location,format:t=>`${t}`,sortable:!0},{name:"to_location",align:"left",label:"Destino",field:"to_location",sortable:!0},{name:"from_date",align:"left",label:"Data Saída",field:"from_date",sortable:!0},{name:"status",align:"left",label:"Estado",field:"status",sortable:!1}],loading:!1,data:[],rows:[],status:""}},computed:{params:function(){let t=new URLSearchParams(location.search);return console.log("logs ",t.get("status")),t}},methods:{goTo(t,e,a){console.log(e),this.$router.push("viagem/"+e.id)},async getRowsNumberCount(t){let e=0;return await this.$axios.get("freight-journey/search/count?filter="+t+"&news="+this.params.get("news")).then((t=>{e=t.data,e=parseInt(e)})),e},async fetchFromServer(t,e,a,s,o){let i=[];return await this.$axios.get(`/freight-journey/global/search/?filter=${a}&startRow=${t}&fetchCount=${e}&sortBy=${s}&descending=${o}&status=${this.status}&news=${this.params.get("news")}`).then((t=>{console.log("done",t.data),i=t.data})),i},async onRequest(t){console.log("props",t);const{page:e,rowsPerPage:a,sortBy:s,descending:o}=t?t.pagination:this.pagination,i=this.filter;this.loading=!0,this.pagination.rowsNumber=await this.getRowsNumberCount(i);const n=0===a?this.pagination.rowsNumber:a,r=(e-1)*a,l=await this.fetchFromServer(r,n,i,s,o);this.rows.splice(0,this.rows.length,...l),console.log("rows ",this.rows),this.pagination.page=e,this.pagination.rowsPerPage=a,this.pagination.sortBy=s,this.pagination.descending=o,console.log("pagination",this.pagination),this.loading=!1}},async beforeMount(){let t=await this.getRowsNumberCount("");this.pagination.rowsNumber=t,this.onRequest()}},r=n,l=a("2877"),c=a("eaac"),d=a("27f9"),u=a("0016"),g=a("eebe"),p=a.n(g),f=Object(l["a"])(r,s,o,!1,null,null,null);e["default"]=f.exports;p()(f,"components",{QTable:c["a"],QInput:d["a"],QIcon:u["a"]})}}]);